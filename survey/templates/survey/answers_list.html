{% extends "survey/base.html" %}{% load propmgr %}
{% block scripts %}{% load adminmedia %}
<style type="text/css">
.question pre { margin-left: 2em; }
.question .bar { margin-left: 2em; }
.question .barAnswer { font-weight: bold; width: 100% !important; text-align: left;}
.question .answer { margin-left: 2em; }
.question .question-results .barColor {
    background-color: #7ca0c7;
    background-image: url({% admin_media_prefix %}img/admin/default-bg.gif);
    background-repeat: repeat-x;
    background-attachment: scroll;
    padding: 0px;
    background-x-position: left;
    background-y-position: top;
}
</style>
{% endblock %}
{% block content %}
<h1>{{ title }} <i>({{ survey.submission_count }} Submission{{ survey.submission_count|pluralize:"s" }})</i></h1>
<br/>
{% for question in survey.questions.all %}
<div class='question'>
    <h2 onmouseout='this.style.backgroundColor="#FFF";'
        onmouseover='this.style.backgroundColor="#ECECEC";'
        onclick='var foo=document.getElementById("results{{forloop.counter}}");
                 if (foo.style.display=="none") { foo.style.display="block"; }
                 else { foo.style.display="none"; }'
    >{{ question.text|escape }} <i>({{ question.answer_count }} {% if question.choices.count %}Vote{% else %}Answer{% endif %}{{ question.answer_count|pluralize:"s" }})</i></h2>
    <div id='results{{forloop.counter}}' class='question-results'>
{% if question.choices.count %}
    {% for choice in question.choices %}
        <table border="0" cellpadding="0" cellspacing="0" class="bar">
            <caption class="barAnswer">{% ifequal question.qtype "I" %}<img src="{{ choice.text }}"/>{% else %}{{ choice.text|escape }}{% endifequal %}</caption>
            <tr>
                <td style="width: {% widthratio choice.count question.answer_count 100 %}%" class="barColor">{% if choice.count %}&nbsp;{% endif %}</td>
                <td class="barPercent"><strong class="barVotes">{{ choice.count }}&nbsp;vote{{ choice.count|pluralize:"s" }}</strong>&nbsp;/&nbsp;{% widthratio choice.count question.answer_count 100 %}%</td>
            </tr>
        </table>
    {% endfor %}
{% else %}
    {% for answer in question.answers.all %}
        <div>{% if view_submissions %}<a href='{{ answer.session_key }}/'>{% endif %}Answer {{ forloop.counter }}{% if view_submissions %}</a>{% endif %} of {{ question.answer_count }}</div>
        <div class="answer">{{ answer.text|escape|preserveindentbr }}</div>
        <hr/>
    {% endfor %}
{% endif %}
    <br/>
    </div>
</div>
{% endfor %}
{% endblock %}
